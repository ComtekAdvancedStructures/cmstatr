---
title: "cmstatr Tutorial"
author: "Stefan Kloppenborg"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{cmstatr Tutorial}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

`cmstatr` is an R package for analyzing composite material data for use in the aerospace industry. The statistical methods are based on those published in [CMH-17-1G](https://www.cmh17.org/). This package is intended to facilitate reproducible statistical analysis of composite materials. In this tutorial, we'll explore the basic functionality of `cmstatr`.

# Input Data
`cmstatr` is build with the assumption that the data is in (so called) [tidy data](http://vita.had.co.nz/papers/tidy-data.html) format. This means that the data is in a data frame and that each observation (i.e. test result) has its own row and that each variable has its own column. Included in this package is a sample composite material data set (this data set is fictional: don't use it for anything other than learning this package). The data set `carbon.fabric` has the expected format.

```{r}
library(cmstatr)

carbon.fabric
```

If your data set is not yet in this type of format (note: that the column names *do not* need to match the column names in the example), there are many ways to get it into this format. One of the easier ways of doing so is to use the [tidyr](https://tidyr.tidyverse.org/) package. The use of this package is outside the scope of this vignette.

# Working With Data
Throughout this vignette, we will be using some of the `tidyverse` tools for working with data. There are several ways to work with data in R, but in the opinion of the author of this vignette, the `tidyverse` provides the easiest way to do so. As such, this is the approach used in this vignette. Feel free to use whichever approach works best for you.

To load the various packages that make up the `tidyverse`, simply load them as follows:

```{r}
library(tidyverse)
```

# Calculating Single-Point Basis Value
The simplest thing that you will likely do is to calculate a basis value based of a set of numbers that you consider as unstructured data. An example of this would be calculating the B-Basis of the `RTD` warp tension (`WT`) data.

```{r}
carbon.fabric %>%
  filter(test == "WT" & condition == "RTD") %>%
  basis_normal(strength)
```

# Equivalency
Eventually, once you've finished calculating all your basis values, you'll probably want to set specification requirements or evaluate site/process equivalency. `cmstatr` has functionality to do both.

Let's say that you want to develop specification limits for warp tension that you're going to put in your material specification. You can do this as follows:

```{r}
carbon.fabric %>%
  filter(test == "WT" & condition == "RTD") %>%
  equiv_mean_extremum(strength, n_sample = 5, alpha = 0.01)
```

